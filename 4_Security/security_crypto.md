# 정보보안/암호학

### 암호화

* Confusion/Diffusion
  * 혼돈(Confusion)
    * 암호문에서 키를 알아내기 어렵게 하는 성질
    * 혼돈은 암호문을 보고 원문을 짐작하기 어렵게 만든다
  * 확산(Diffusion)
    * 암호문에서 원본 메세지를 알아내기 어렵게 하는 성질
    * 평문을 구성하는 각각의 비트들의 정보가 여러개의 암호문 비트에 영향을 미쳐야 함

---

### 블록암호

* DES
  * 64 비트 블록
  * 56비트 키
  * 16라운드, 페이스텔 구조
* AES
  * 128비트 블록
  * 128/192/256 키
  * 10, 12, 14 라운드로 구성, 비 페이스텔 구조
  * 순서
    * Add Round Key >> [S-box(Substition bytes) >> Shift Row >> Mix Column >> Add Round Key] * 라운드 수
* IDEA
  * 유럽 개발
  * 64비트 블록, 128비트 키
  * PGP의 암호 알고리즘으로 채택

---

### 블록암호 모드

* ECB모드
  * 평문을 동일한 블럭으로 나눠서 같은 방식으로 암호화
  * 패턴이 나타나기 때문에 안정성이 떨어진다.
* CBC모드
  * IV를 사용하고 평문과 XOR 한 뒤 암호화
  * 오류전이 발생
* CFB모드
  * IV를 암호화하고 결과를 평문과 XOR 한 결과를 다음 연산에 피드백
  * **XOR 이후에 피드백**
  * **암호화 방법과 복호화 방법이 동일**
  * 오류전이 발생
* OFB모드
  * IV를 암호화하고 다음 연산에 피드백, 평문과 XOR
  * **XOR 이전에 피드백**
  * **암호화 방법과 복호화 방법이 동일**
  * 오류전이 X
* CTR 모드
  * 카운터를 암호화, 이를 평문블럭과 XOR
  * **암호화 방법과 복호화 방법이 동일**

---

### 대칭키 암호화

#### DES

* 페이스텔 구조 암호
* 고정된 라운드 수와 키 길이
  * 블록 길이 : 64비트
  * 키 길이 : 56비트
  * 라운드 수 : 16
*  S-box로 인해 혼돈과 확산 성질이 충족된다.

* 국내 : SEED

#### AES

* 10/12/14 라운드 수와 이에 대응해 128/192/256비트의 키 길이를 갖는다
* 순서
  * Add round key
  * Substitute bytes
  * Shift rows
  * Mix columns
  * Add round key

* 국내 : ARIA

---

### 공개키 암호화

#### 디피-헬먼

> 최초의 공개키 암호화 알고리즘으로 1976년에 Diffie와 Hellman에 의해 개발

* 소수 p가 충분히 클 때 주어진 두 개의 공개 값들 g<sup>a</sup> mod p와 g<sup>b</sup> mod p를 가지고 공유된 비밀키 g<sup>ab</sup> mod p를 계산하는 것이 불가능하다고 가정한 **이산대수 문제**를 기반으로 함

* 키 교환을 하는 대상과 비밀 정보를 공유할 수 있지만, 상대방에 대한 인증은 보장되지 않아 중간자 공격(MITM)이 가능

* IPSEC에서 IKE(Inter Key Exchange)의 기본 키 교환 알고리즘으로 채택

  ```
  # 빠른 모듈러 연산(거듭제곱법)
  (A * B) % C = (A % C) * (B % C) % C
  ```

#### DSA

* Digital Signature Algorithm, Elgamal 사용
* **이산대수 문제** Y = g<sup>x</sup> mod p 에서 Y, g, p을 공개하더라도 x를 계산하기 어렵다는 가정
* x는 개인키, Y는 공개키로 사용
* 난수 k를 이용하므로 매 암호화 시 다른 암호문을 얻어 RSA에 비해 더 안전함
* 암호문의 길이가 평문 길이의 두배가 되는 단점 존재

#### RSA

* **소인수분해**의 어려움을 기반으로 하며 키 사이즈는 2048bit 권장
* 기밀성과 부인방지 기능 제공
* 암호화
  * C = M<sup>e</sup> mod N
* 복호화
  * M = C<sup>d</sup> mod N
* 예제문제
  * 두 소수 p = 17, q = 23이고 평문 M = 8, 키 값 e = 3 일때, c를 구하라
    * N = pq 이므로 391
    * c = M<sup>e</sup> mod N 이므로 c = 121
  * p = 13, q = 11일 때, 키 값 e, d를 구하라
    * N = pq 이므로 33
    * φ(n)=(p-1)(q-1) 을 구하면 120
    * φ(n) 보다 작으면서 서로소인 e를 구하면 13
    * ed = 1 mod φ(n) 이므로 d는 37
    * 공개키 (N, e) = (33, 3) / 개인키 d = 37

#### Rabin

* RSA 알고리즘의 변형, 마찬가지로 **소인수분해**의 어려움을 기반
* RSA는 e,d라는 지수를 사용하지만, Rabin은 e,d가 2로 고정되어 있어 RSA보다 암호화 연산이 빠름

#### ECC

* **타원곡선상에서 이산대수의 어려움**을 기반으로한 공개키 암호 알고리즘
* 기존 공개키 암호화보다 짧은 키의 길이로 동일한 안전성을 제공 (RSA 1024bit = ECC 160bit)
* 타원곡선상의 덧셈연산을 이용하여 구현한다
* 무선 환경과 같이 전송량과 계산량이 상대적으로 열악한 환경에 적합
* 이론적으로 복잡하여 실제 구현이 어려움

___

### 해시

* 특성
  * 1역상 저항성
    * 역상 저항성은 해시 값이 주어졌을 때, 그 해시 값을 생성하는 입력값을 알아내기가 불가능하다는 특성
    * 주어진 해시 값이 H가 있다면 그 해시 값을 생성하는 H=Hash(M)의 M을 계산하기가 어려워야 한다.
  * 제2 역상저항성(약한 충돌 회피성)
    * 어떤 입력 값과 동일한 해시 값(결과 값)을 가지는 다른 입력 값을 찾을 수 없어야 한다는 특성
    * 어떤 입력값 M1 에 대해 M1≠M2이며, Hash(M1)=Hash(M2) 인 M2를 찾을 수 없어야 함
  * 충돌 저항성(강한 충돌 회피성)
    * 해시 값 (결과 값)이 이 같은 입력 값 두 개를 찾을 수 없다는 특성
    * 동일 해시값을 생성하는 M1, M2를 찾기 어려워야 한다.
* salt
  * pw+salt를 hash하면 사전공격을 예방가능
  * timestamp, nonce를 salt에 활용

| **알고리즘**    | **해시값 크기** | **내부 상태 크기** | **블록 크기** | **메시지 길이(2<sup>n</sup>)** | **워드 크기** | **과정 수** | **사용되는 연산**     | **충돌** |
| --------------- | --------------- | ------------------ | ------------- | ------------------------------ | ------------- | ----------- | --------------------- | -------- |
| **SHA-0**       | 160             | 160                | 512           | 64                             | 32            | 80          | +,and,or,xor,rotl     | 발견됨   |
| **SHA-1**       | 160             | 160                | 512           | 64                             | 32            | 80          | +,and,or,xor,rotl     | 발견됨   |
| **SHA-256/224** | 256/224         | 256                | 512           | 64                             | 32            | 64          | +,and,or,xor,shr,rotr | -        |
| **SHA-512/384** | 512/384         | 512                | 1024          | 128                            | 64            | 80          | +,and,or,xor,shr,rotr | -        |

---

### 암호공격

* 차분공격
  * chosen plaintext cryptanlysis의 일종으로  블록 암호에서 입력쌍의 차이(Input difference)와 해당 출력쌍에 대한 차이(Output difference) 값들의  **확률 분포가 균일하지 않다**는 사실을 이용하여 공격하는 방법이다. 입력에 따른 출력의 변화를 이용하여 암호를 공격하는 방법이다.
* 부채널공격
  * 암호 알고리즘에 대한 공격이 아닌 전력 소모량, 연산시간, 음향 등 부가적인 정보를 활용하여 공격하는 기법
  * **하드웨어적**인 공격기법(전력분석, 시차분석, 전자파분석)
* 중간자공격
  * DH 혹은 RSA와 같은 공개키 알고리즘에서 a와 b의 사이에서 g<sup>at</sup> 와 g<sup>bt</sup>를 만드는 공격기법
* 재전송공격
  * a와 b의 메세지를 가로채서 a의 메세지를 그대로 재전송하는 기법
* 레인보우 테이블 공격
  * **해시값** 목록을 미리 저장해놓음
* 사전공격
  * **PW** 목록을 미리 저장해놓음
* 은닉채널
  * 은닉채널(Covert Channel)은 데이터 전송 시 평소에 잘 사용하지 않는 공간에 공격 명령어 및 코드를 담아 전송하는 공격 방법이다.
  * ICMP, DNS, TCP에 ack등에 데이터를 넣어 전송할 수 있다.
  * 세션을 맺지 않고 공격하기에 로그기록이 남지않고 방화벽을 우회 가능하다.


**암호문 공격방법**

1. 암호문 단독
   * 암호문만 알고있는 상태, 가장 어려운 방법
2. 알려진 평문(기지평문)
   * 일정부분의 평문과 이에 대응하는 암호문을 알고있는 상태
3. 선택 평문
   * 공격자가 암호장치에 얼마든지 접근할 수 있어서 선택된 평문을 입력하고 그에 대한 암호문을 얻을 수 있는 상황
   * 암호화 매커니즘은 모르지만 원하는대로 원하는 평문을 암호화 시켜볼 수 있어 파악이 용이
4. 선택암호문
   * 암호문을 고르면 복호화된 평문을 얻을 수 있는 경우 + 선택 평문도 가능
   * 선택암호문공격에서는 평문 값과 암호문 값 모두를 선택한다. 공격자가 선택하는 모든 평문에 대응하는 암호문을 얻고 공격자가 선택한 각 암호문에 대응하는 평문을 얻는다.
   * 물론 암호화 매커니즘은 모른다.

**위험한 순서**

* 선택암호문 -> 선택평문 -> 기지평문 -> 암호문 단독

---

### 하이브리드 암호

* 공개키 + 대칭키 암호시스템

* 공개키 암호의 처리속도가 느린 것을 대칭키 암호로 해결하고, 대칭키 암호의 키 배송 문제를 공개키 암호로 해결
* 특징
  * 메시지는 대칭키 암호로 암호화
  * 대칭키 암호의 암호화에서 사용한 세션키는 의사난수생성기로 생성
  * 세션키는 공개키 암호로 암호화

---

