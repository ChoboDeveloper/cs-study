# 정보보안/공격

### 악성코드

* 스파이웨어

사용자의 PC에서 사전 동의 없이 설치되어 컴퓨터의 정보와 개인 정보를 수집하는 악성코드

컴퓨터에서 정보를 수집해서 다른 시스템으로 전송하는 SW

* 크라임웨어

온라인을 통해 불법적인 행동을 하기 위해 만들어진 프로그램

* 백도어

감염된 사용자 PC에 특정 포트를 열어두어 정상적인 인증 과정 없이 원격 접속을 통해 직접 조작하는 형태로, 사용자 몰래 특정 파일을 삭제하거나 파일이나 정보를 빼가는 등의 행위를 한다.

* 키로거

컴퓨터가 입력받는 정보를 기록하는 것으로 그 중에서도 주로 키보드를 통한 메시지를 중간에 가로채서 기록하는 형태를 말한다. 

* 드롭퍼

일종의 악성 프로그램의 설치 프로그램의 형태로, 실행 시 내부에 포함되어 있던 바이러스나 웜, 또는 트로이 목마 등의 악의적인 프로그램이 설치되는 형태의 악성코드를 말한다.

* 다운로더

프로그램에서 지정한 웹 사이트에 접속하여 추가 악성코드를 다운로드하여 실행시키는 악성코드. 다운로더는 드롭퍼와 같이 백신 프로그램을 우회하는 목적으로 사용된다.

* 루트킷

자신의 또는 다른 소프트웨어의 존재를 가림과 동시에 허가되지 않은 컴퓨터나 소프트웨어의 영역에 접근할 수 있게 하는 용도로 설계

* 부트킷

 PC의 부팅영역인 MBR(Master Boot Record)를 조작하는 프로그램을 칭하는 이름으로, 크게 파괴형 부트킷과 은신형 부트킷으로 나뉜다.

* Bot

인간의 행동을 흉내 내는 프로그램으로 DDoS 공격을 수행한다

* Zombie

감염된 컴퓨터에서 활성화되는 프로그램으로 다른 컴퓨터에 대한 공격을 시작하는 데 사용됨

* 웜

스스로를 복제하는 악성 소프트웨어 컴퓨터 프로그램

---

### 바이러스

* 원시형 바이러스

프로그램 구조가 단순하고 분석이 상대적으로 쉽다. 

돌 바이러스, 예루살렘 바이러스 등 기존의 도스용 바이러스 대부분이 포함된다.

* 암호화 바이러스

프로그램의 일부 또는 대부분을 암호화시켜 저장한다. 

폭포 바이러스, 느림보 바이러스 등이 있다.

* 은폐형 바이러스

기억장소에 존재하면서 감염된 파일의 길이가 증가되지 않은 것처럼 보이게 하며, 백신 프로그램이 감염된 부분을 읽을 때 감염되기 전의 내용을 보여준다.

브레인 바이러스, 조쉬 바이러스, 방랑자.1347 바이러스 등이 있다.

* 갑옷형 바이러스

백신 프로그램으로부터 숨기보다는 여러 단계의 암호화와 다양한 기법을 통해 바이러스 분석을 어렵게 하고 백신 프로그램 개발을 지연시켰다.

* 매크로 바이러스

운영체제와 관계없이 동작하는 응용 프로그램 내부에서 동작한다. 매크로 언어가 포함된 MS사 오피스 제품군과 비지오, 오토캐드 등 VBS를 지원하는 다양한 프로그램에서 활동한다. 

워드 컨셉, 엑셀-라룩스, 멜리사 바이러스 등이 있다.

> 매크로
>
> C/C++ 등, 매크로를 지원하는 언어에서 약식 문법을 정의하면, 컴파일러가 컴파일을 하기 전에 약식 문법으로 정의된 코드를 원래 코드로 변환을 한 후 컴파일한다.

* 스텔스 바이러스

어떤 백신 프로그램으로도 예방 또는 감염경로를 확인할 수 없는 최악의 컴퓨터 바이러스

* 다변형 바이러스

감염시킬 때마다 바이트 패턴을 변형하는 바이러스, 특징을 이용한 탐지가 불가능

* 메타모픽 바이러스

다변형 바이러스와 마찬가지로 감염시킬 때마다 변형하고 추가로 활동하는 방법도 변형

---

### 웹 공격기법

**SQL 인젝션**

SQL 인젝션은 웹 사이트의 보안상 허점을 이용해 특정 SQL 쿼리 문을 전송하여 공격자가 원하는 데이터베이스의 중요한 정보를 가져오는 해킹 기법을 말한다.

* 대응기법
  * 입력 값에 대한 적극적인 유효성 검증
  * 저장 프로시저 사용
    * 저장 프로시저는 사용하자고 하는 Query에 미리 형식을 지정하는 것을 말힌다. 지정된 형식의 데이터가 아니면 Query가 실행되지 않기 때문에 보안성을 크게 향상시킴
  * 인터프리터에 대한 특수 문자 필터링 처리
  * 보안 프로토콜 및 암호 키 사용 여부 확인

**WebShell**

> 웹 서버에 서버에 스크립트 파일을 업로드하여 서버의 정보유출, 악성코드 유포등의 행위를 하는 공격

웹 셸(web shell)은 업로드 취약점을 통하여 시스템에 명령을 내릴 수 있는 코드를 말한다. 

webshell은 간단한 서버 스크립트 (jsp,php,asp ..)로 만드는 방법이 널리 사용되며 이 스크립트들은 웹서버의 취약점을 통해 업로드 된다. 

웹셀 설치시 해커들은 보안 시스템을 피하여 별도의 인증없이 시스템에 쉽게 접속 가능하다.

* 대응기법
  * 업로드 된 파일은 공격자가 추측하기 힘들도록 길고 복잡한 파일명으로 수정하여 저장하도록 하되, 특수 문자의 필터링을 수행한다. 또, 공격자가 추측하기 힘든 복잡한 디렉터리에 저장한다.
  * 업로드 디렉터리 실행권한 제거. FileMatch 지시자를 이용하여 *.ph, *.ine, *.lib 등의 Server Side Script 파일에 대한 직접 URL 호출 금지시킨다. 파일이 업로드 되는 디렉터리에 운영에 필요한 서버 측 스크립트가 존재하는지 확인이 필요하다.

**XSS**

* Reflected XSS
  * URL을 통한 스크립트 삽입

* Stored XSS
  * 웹 사이트에 게시물들을 통해 사용자가 해당 게시물을 확인하기 위해 Request했을 때, 웹 서버에 저장된 공격 스크립트까지 포함한 Response가 전달된다.

---

### 무선랜 공격기법

#### Rogue AP

> 공격자가 설치한 부정한 AP 로 사용자 접속을 유도하는 공격 기법

* 공격자는 무선 네트워크상에 자신의 AP 신호의 강도를 높여 접속을 유도
* 신호의 강도가 강한 AP로 접속한다는 네트워크 접속 방식을 이용한 공격
* 공격자는 사용자가 접속하기를 기다리는 방식

---

### 포트 스캔 공격

**OPEN 스캔**

> 스캔하는 포트에 해당되는 서비스의 활성화 여부를 조사할 수 있는 방법
>
> TCP Open 스캔과 UDP Open 스캔 기법으로 나뉜다

* **TCP Full Open 스캔(TCP Connect 스캔)**
  * 포트가 열려 있는 경우 대상시스템으로부터 SYN/ACK 패킷을 수신하면 그에 대한 ACK 패킷을 전송함으로써 연결을 완료하는 방식이다.
  * 포트가 닫혀 있을 경우 대상 시스템이 연결 요청을 받아들이지 못하므로 RST/ACK 패킷(연결 실패)을 전송한다.
  * 속도가 느리고 로그를 남기므로 탐지가 가능하다는 단점이 있음
* **TCP Half Open 스캔(TCP SYN 스캔)**
  * 세션에 대한 로그가 남는 TCP Full Open 스캔의 단점을 보완하기 위해 나온 기법으로 로그를 남기지 않아 추적이 불가능 하도록 하는 기법이다.
  * 세션을 완전히 연결하지 않고, TCP Half Connection만으로 포트의 활성화 여부를 판단한다.
  * 공격자의 SYN 세그먼트 전송기록은 남게 되므로 스캐닝 공격사실을 완전히 숨길 수는 없다.
* **UDP 스캔**
  * 스캔하고자 하는 포트를 대상으로 UDP 연결을 시도할 때 ICMP Port Unreachable 에러 메시지가 수신되면 해당 포트를 비활성화를 의미하며, 아무런 응답이 없다면 해당 포트의 활성화를 의미한다.
  * UDP를 이용한 포트 스캔은 신뢰하기 어렵다. UDP 패킷이 네트워크를 통해 전달되는 동안 라우터나 방화벽에 의해 손실될 수 있기 때문이다.

**STEALTH 스캔**

> 스텔스 스캔은 TCP 헤더를 조작하여 특수한 패킷을 만든 후 스캔 대상 시스템에 보내 그 응답으로 포트 활성화 여부를 알아내는 기법

* **FIN 스캔**
  * TCP FIN 스캔은 TCP 헤더 내에 FIN 플래그(연결종료)를 설정하여 공격대상 시스템으로 메시지를 전송하면 스캔 대상 시스템의 포트가 열려 있을 경우에는 응답이 없고, 포트가 닫혀있는 경우에만 RST 패킷이 되돌아오게 된다.
* **NULL 스캔**
  * NULL 패킷은 TCP 헤더 내에 플래그 값을 설정하지 않고, 전송하는 패킷을 말함. 포트가 열려 있을 경우에는 응답이 없고, 포트가 닫혀있는 경우에만 RST 패킷이 되돌아오게 된다.
* **XMAS 스캔**
  * XMAS 패킷은 TCP 헤더 내에 ACK, FIN, RST, SYN, URG 플래그를 모두 설정하여 전송하는 패킷이다.

---

### 버퍼 오버플로우

**대응기법**

* ASLR (Address Space Layout Randomization)
  * 프로세스의 가상 주소 공간에 어떤 obejct가 매핑 될 때 , 그 위치를 프로그램 실행 시 마다 랜덤하게 변경하는 보안기법
* NX(None eXecute) bit
  * NX 비트를 활성화 시켜 스택/힙 영역의 실행 권한을 제거하여 쉘의 실행을 방지하는 기법
*  Stack Guard
  * 스택에 카나리(canary)라는 값을 넣어서 이 값이 변조되었는지 검사하여 버퍼 오버플로우가 발생하였는지 검사하는 기법
* Stack Shield
  * 복귀 주소를 특수 스택에 저장하고 종료 시 해당 스택에 저장된 값과 비교하여 공격을 탐지한다.

---

### TCP 세션 하이재킹

![image](https://user-images.githubusercontent.com/75229881/114658525-eae61080-9d2c-11eb-8236-1729eb91cf0e.png)

1. 스니핑을 통해 세션을 확인하고 적절한 시퀀스 번호를 획득한다.
2. 사용자와 서버간의 TCP 연결을 RST 패킷을 보내 서버 쪽 연결만을 끊는다. (Server-Closed, Client-Established)
3. 공격자는 새로운 시퀀스 번호를 생성하여 서버로 보낸다. (비동기화 상태 만듦)
4. 서버는 새로운 시퀀스 번호를 받아들이며, 다시 세션을 연다.
5. 공격자는 정상적인 연결처럼 서버와 시퀀스 번호를 교환하고 공격자, 서버 모두 Established상태가 된다.



* 6번은 ACK Storm 상태를 의미한다. 이미 세션은 탈취당했고 클라이언트와 서버측의 시퀀스넘버가 맞지 않기 때문에 계속해서 ACK 패킷을 주고받는 상태

![image](https://user-images.githubusercontent.com/75229881/116508958-66cf8380-a8fd-11eb-9ff8-a15ceedbad4f.png)

* 다른 방법으로 클라이언트에 RST/FIN과 서버에 RST를 각각 보내면 ACK STORM 현상이 미발생

---

### DOS

* Land 공격
  * 공격 대상에게 출발지와 목적지가 동일한 패킷 전송
  * 공격 대상은 자신에게 TCP-SYN 패킷을 보내게 되고 빈 연결이 지속적으로 생성되어 DOS 상태가 됌
* Teardrop
  * 패킷의 Fragment Offset 조작
  * 패킷을 겹치거나 빈공간을 만드는 등 offset을 조작하여 이를 재조합하는 공격 대상 시스템에 에러와 부하 유발
  * Bonk는 순서번호가 1번인 Fragment를 계속 보냄
  * Boink는 처음에는 정상적인 순서의 Fragment를 보내다가 점점 순서번호가 어긋난 패킷을 보내는 방법
* Slow HTTP Header(Slowloris)

  * HTTP Header 정보를 비정상적으로 조작하여 웹서버가 온전한 Header정보가 올때 까지 대기하도록 함
* Slow HTTP POST

  * POST 메소드로 대량의 데이터를 장시간에 걸쳐 분할 전송하여 연결을 장시간 유지
  * 예를들어,  Content-Length를 100000byte로 하고 데이터는 일정한 간격으로 1byte씩 전송
* Slow HTTP Read
  * 매우 작은 윈도우크기로 서버에 응답을 보내면 서버는 더 이상 데이터를 전송하지 못하고 연결만 유지한 상태로 대기
    * TCP의 Window size 버퍼에 한 번에 담을 수 있는 양

---

### DDOS

**Flooding**

* HTTP GET Flooding
  * 대량의 HTTP GET 요청
  * with CC(cache-control)
    * HTTP 헤더의 Cache-Control: no-store, must-revalidate로 지정하여 웹 서버가 캐시를 사용하지 못하도록 하여 일반적인 DDOS보다 적은 양으로도 DOS 상태에 빠지게 만든다.

---

### DRDoS

> (Distributed Reflection Denial of Service)

* 공격 트래픽이 수많은 반사 서버를 경유하기 때문에 공격의 근원지 파악해 역추적 거의 불가능
* IP Spoofing을 이용한 공격이다

---

### FTP Attack

**FTP Bounce 공격**

* FTP 서버가 데이터를 데이터 포트(20)로 전송할 때 목적지가 어딘지 검사하지 않는 프로토콜 구조적 문제점을 이용
* 익명 FTP 서버를 이용해 공격자가 자신을 숨기고 PORT 명령을 조작하여 공격대상의 **네트워크 및 포트스캔, Fake Mail 전송, 데이터 전송**이 가능
* 이렇게 연결이되면 방화벽의 내부에 존재하기 때문에 방화벽의 패킷 필터링을 완전히 무시하고 침입이 가능하다
* 포트 스캐닝에 자주 사용된다

**Anonymous FTP 공격**

* 익명 FTP는 누구나 서버에 접근가능하고 따라서 쓰기 권한이 있다면 악성코드를 업로드 할 수도 있음
* 익명 FTP 접속 차단을 통해 해결

**TFTP 공격**

* TFTP는 69/udp 포트를 사용하고 인증절차가 없기 때문에 접근제어가 제대로 안되어 있으면 임의로 디렉터리 및 파일에 접근 가능

---

