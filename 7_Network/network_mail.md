# 네트워크/전자메일

<br>

### SMTP

* 인터넷 전자우편 표준 프로토콜
* 포트 25, 응용계층
* Store-and-Forward 방식으로 메시지를 전달한다.
* 상대 서버를 지시하기 위해 DNS의 MX 레코드 (Mail Exchanger) 가 사용된다.



<img src = "https://user-images.githubusercontent.com/75229881/116352002-813b2b80-a82f-11eb-834a-03223485803e.png" width="70%">

**구성요소**

* Mail Transfer Agent (MTA)
  * 서버안의 하나의 메일 전송 에이전트
  * (송신 시) 사용자로부터 메일을 전달받아서 외부로 전달해주는 프로그램
  * (수신 시)  외부로부터 MTA가 메일을 수신하면, 적절한 MDA에게 메일을 전달한다.
* Mail Delivery Agent (MDA)
  * 사용자의 메일함으로 메일을 저장해주는 프로그램
  * 외부로부터 수신한 메일을 MTA가 MDA에게 전달해주면, MDA는 해당 사용자의 메일함에다가 저장한다.
* Mail User Agent (MUA)
  * 사용자가 메일 송/수신을 위해 사용하는 클라이언트 프로그램
  * 메일을 작성하거나 메일함에 도착한 메일을 보여주는 기능을 수행한다.
* MRA/MAA
  * 리모트 서버에 있는 우편함으로부터 사용자의 MUA로 메시지를 가져오는 프로그램

---

### 전자우편 보안

* 기밀성, 인증, 무결성, 부인방지를 제공한다.

* 대표적으로 PGP, PEM, S/MIME 등이 있다.

* PEM

  * 보안성이 높지만 구현과 사용이 어렵다.
  * 전자우편 사용 시 전송하기 전에 자동으로 암호화하여 전송도중 노출되어도 내용을 알 수 없다.

* PGP(Pretty Good Privacy)

  * 구현이 용이함
  * 송신 부인방지는 지원하지만 수신 부인방지는 미지원
  * PGP는 사용자에게 여러 쌍의 개인키, 공개키를 허용한다. 그래서 이 키 들을 관리하는게 Keyring이다.
  * WOT(Web of Trust) 사용, 수평적 구조

  | 기능                  | 알고리즘                         | 설명                                                         |
  | :-------------------- | :------------------------------- | :----------------------------------------------------------- |
  | 기밀성(메시지 암호화) | Triple-DES,IDEA, CAST, RSA       | 송신자가 생성한 일회용 세션키로 알고리즘을 이용해 메시지 암호화.<br>수신자의 공개키로 RSA를 이용해서 세션키를 암호화하고 메시지에 첨부. |
  | 인증(전자 서명)       | RSA, DSS, SHA-1, MD5, RIPEMD-160 | 해시 알고리즘을 이용해서 메시지 다이제스트를 생성.<br>메시지 다이제스트는 송신자의 개인키로 DSS나 RSA를 이용해서 암호화한 후 메시지에 첨부한다. |
  | 압축                  | ZIP                              | ZIP으로 메시지를 압축한다.                                   |
  | 호환성                | Radix-64 변환                    | Radix-64 변환을 이용해 ASCII 부호로 변환한다.                |

* S/MIME(Secure Multipurpose Internet Mail Extensions)

  *  S/MIME은 기존 전자 우편 보안 시스템의 문제점인 PEM 구현의 복잡성과, PGP의 낮은 보안성과 기존 시스템과의 통합이 용이하지 않다는 점을 보안하기 위해 개발된 우편 보안 시스템이다.
  *  CA에서 발행한 X.509 사용, 수직적 구조
  *  enveloped Data는 수신자의 공개키로 세션키를 암호화하고 메시지를 세션키로 암호화하여 보낸다. 수신자는 개인키로 세션키를 얻고 이를 통해 메시지를 복원할 수 있다.
  *  서명 및 봉인된 데이터(Signed-and-enveloped Data)란 송신자가 MIME 메시지를 암호화하고, 암호화된 MIME 메시지에 송신자 자신의 개인키(private key)를 이용하여 전자서명한 데이터를 의미한다.
  *  enveloped Data는 서명될 수 있고, signed Data는 암호화될 수 있다.

---

